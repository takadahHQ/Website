{% extends 'base.html' %}
{% load flag_tags %}
{% load advert_tags %}
{% load tailwind_filters %}

{% block title %}
{{ story.title | title }}
{% endblock title %}
{% block breadcrumbs %}
<li><a href="{{ story.story.story_type.get_absolute_url}}">{{ story.story.story_type.name }}</a></li> 
<li><a href="{{ story.story.get_absolute_url}}">{{ story.story.title }}</a></li> 
<li><a>{{ story.title }}</a></li> 
{% endblock %}
{% block content %}
<!-- Story Detials -->
<section class="w-full">
    <div class="bg-white dark:bg-mono-800 dark:text-mono-200">
        <div class="w-full p-8">
          <div class="btn-group w-auto">
            {% if story.get_previous %}
        <a class="btn btn-outline  w-1/3 dark:invert" href="{{ story.get_previous }}">Previous</a>
        {% else %}
        <div class="btn btn-outline  w-1/3 dark:invert" disabled="disabled">First Chapter</div>
        {% endif %}
        <div class="btn w-1/3 bg-transparent border-transparent btn-link">
          <a class="text-sm lg:text-2xl text-center" href="{{ story.story.get_absolute_url }}"><h1 class="text-xs text-2xl card-title object-fill dark:text-mono-100">Chapter - {{ story.position }}</h1></a>
        </div>
        {% if story.get_next %}
        <a class="btn btn-outline  w-1/3 dark:invert" href="{{ story.get_next }}">Next</a>
        {% else %}
        <div class="btn btn-outline  w-1/3 dark:invert" disabled="disabled">Last Chapter</div>
        {% endif %}
        </div>
        </div>
        
        <div class="flex flex-col p-8">
            <div class="w-full  h-full bg-mono-50 dark:bg-mono-700 shadow-md card">
                <div class="card-body">
                  <h1 class="text-xl text-mono-800 card-title dark:text-mono-200">Chapter - {{ story.position }}: {{ story.title }}</h1>
                  <p class="text-base text-mono-600 dark:text-mono-400">{{ story.text| safe }}</p>
                </div>
              </div>
              {% if story.authors_note %}
              <div class="w-full h-full bg-mono-50 dark:bg-mono-700 shadow-md card mt-2">
                <div class="card-body">
                  <h1 class="text-xl text-mono-800 dark:text-mono-200 card-title"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
</svg>Authors Note</h1>
                  
                      <p class="text-base text-mono-600 dark:text-mono-200">{{ story.authors_note| safe }}</p>
                 
                </div>
              </div>
              {% endif %}
              <div class="p-8 align-center flex justify-evenly">
                {% comment %} {% render_flag_form story user request %} {% endcomment %}
                </div>
        </div>
        <div class="w-full p-8 align-center flex justify-evenly">
            {% if story.get_next %}
        <a class="btn btn-outline  w-1/3 dark:invert" href="{{ story.get_next }}">Next</a>
        {% else %}
        {% if packages %}
        {% include "stories/partials/sponsor.html" %}
        {% else %}
        <div class="btn btn-outline  w-1/3 dark:invert dark:text-mono-500" disabled="disabled">Last Chapter</div>
        {% endif %}
        {% endif %}
        </div>
        </div>
</section>
{% include "stories/includes/comments.html" %}
<!-- button -->
<button x-data="topBtn" @click="scrolltoTop" id="topButton"
class="fixed z-10 hidden p-3 bg-gray-100 rounded-full shadow-md bottom-10 right-10 animate-bounce">
<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M5 10l7-7m0 0l7 7m-7-7v18">
    </path>
</svg>
</button>

<script>
document.addEventListener('alpine:init', () => {
    Alpine.data('topBtn', () => ({
        scrolltoTop() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }
    }));
});

const topBtn = document.getElementById("topButton");
window.onscroll = () => {
    (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) ?
    topBtn.classList.remove("hidden"): topBtn.classList.add("hidden");

}
</script>
{% endblock content %}